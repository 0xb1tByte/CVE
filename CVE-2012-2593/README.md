# AtMail Email Server Appliance 6.3.6 - (XSS > CSRF > RCE)

## Requirements
- python : `smtplib`
- python : `requests`

## How it works
The XSS & CSRF vulnerabilities will be chained together to perform the following :
 - [1] `CSRF : globalsave vulnerability` (Code Review): 
   - Send an email to the admin containing an XSS payload (`globalsave.js` injected into `Date` header)
   - The XSS payload will re-set the `tmpFolderBaseName` to `null/empty value` to force the application to save our webshell under `/webmail` directory (the path that we can access)
- [2] `CSRF : addattachment vulnerability` (Code Review) : 
   - Send an email to the admin containing an XSS payload (`addAttachment.js` injected into `Date` header)
   - The XSS payload attaches the `php-reverse-shell.php` file to the email
- [3] Accessing the uploaded file to execute our webshell

## Exploit files:
- `globalsave.js` XSS payload
- `addAttachment.js` XSS payload
- `php-reverse-shell.php` reverse-shell 
- `fileToBase64.py` : can be used to convert the `php-reverse-shell.php` content to `base64` then the `base64` can be added to the `addAttachment.js` payload
- `CVE-2012-2593.py` : the PoC that performs the [1],[2],[3] steps

## Sample Output : 
![alt text](https://github.com/0xb1tByte/CVE/blob/main/CVE-2012-2593/1.png)
![alt text](https://github.com/0xb1tByte/CVE/blob/main/CVE-2012-2593/2.png)
